<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>isla-axiomatic</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>isla-axiomatic</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_command_line_interface">Command line interface</a>
<ul class="sectlevel2">
<li><a href="#_viewing_the_output">Viewing the output</a></li>
<li><a href="#_comparing_with_reference_results">Comparing with reference results</a></li>
<li><a href="#_advanced_features">Advanced features</a></li>
</ul>
</li>
<li><a href="#_litmus_input_format">Litmus input format</a>
<ul class="sectlevel2">
<li><a href="#_threads">Threads</a></li>
<li><a href="#_final_state">Final State</a></li>
<li><a href="#_custom_sections">Custom sections</a></li>
<li><a href="#_self_modifying_code">Self-modifying code</a></li>
<li><a href="#_constrained_addresses">Constrained addresses</a></li>
<li><a href="#_herd_litmus_files">Herd <code>.litmus</code> files</a></li>
</ul>
</li>
<li><a href="#_memory_model_language">Memory model language</a></li>
<li><a href="#_linking_sail_models_with_memory_models">Linking Sail models with memory models</a>
<ul class="sectlevel2">
<li><a href="#_dependency_analysis">Dependency analysis</a></li>
<li><a href="#_dependency_analysis_for_systems_semantics">Dependency analysis for systems semantics</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><code>isla-axiomatic</code> allows running concurrency litmus tests w.r.t. an
axiomatic memory model specified in the cat language used by
<a href="https://github.com/herd/herdtools7">herdtools</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_command_line_interface">Command line interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a simple example the following command will test whether the MP test is
allowed by the <code>aarch64.cat</code> memory model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">target/release/isla-axiomatic -A aarch64.ir -C configs/aarch64.toml -m aarch64.cat MP.toml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-A</code> option and <code>-C</code> options are used to specify the architecture
and the configuration file. The <code>.ir</code> file is a compiled
representation of the intermediate representation generated by
Sail. Sample configurations for our models are included
in the isla repository itself, within the configs directory.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Short options using a capital letter are shared between all isla command line tools.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>-m</code> (<code>--model</code>) option gives a model specified in the Cat language.</p>
</div>
<div class="paragraph">
<p>The <code>-s</code> (<code>--timeout</code>) option sets a timeout in seconds.</p>
</div>
<div class="paragraph">
<p>The <code>-e</code> (<code>--exhaustive</code>) option causes the tool to attempt to exhaustively enumerate
all possible executions.</p>
</div>
<div class="paragraph">
<p>Any files passed on the command line without any options such as
<code>MP.toml</code> above specify tests using the TOML-based litmus format
specified below. Multiple files can be passed, e.g. by using <code>*.toml</code>
or similar. It can also be specified using the <code>.litmus</code> format used
by Herd. If this is the case, <code>isla-axiomatic</code> will attempt to invoke
the <code>isla-litmus</code> conversion tool automatically. See the section below
on <code>.litmus</code> files for more information.</p>
</div>
<div class="sect2">
<h3 id="_viewing_the_output">Viewing the output</h3>
<div class="paragraph">
<p>The <code>--view</code> flag will cause the output to be displayed as a graphviz
generated graph using <code>xdg-open</code> to open an image viewer. The flag
<code>--dot &lt;path&gt;</code> will instead generate the dot files used by graphviz in
the directory specified by <code>&lt;path&gt;</code>. The <code>--temp-dot</code> flag will
generate the dot files in either the default system temporary files
directory (typically <code>/tmp</code> on Linux) or in <code>TMPDIR</code> if the
environment variable is set. <code>--view</code> implies <code>--temp-dot</code> unless
<code>--dot</code> is used.</p>
</div>
<div class="paragraph">
<p>If we append <code>--dot .</code> to our command in the previous section it will
generate a file <code>MP_1.dot</code> in the current directory (if the test had
multiple allowed executions, they would be <code>MP_2.dot</code> and so on). We
can then use the <code>dot</code> command from graphviz to generate an image,
like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">dot -Tpng -o MP.png MP_1.dot</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate the following picture:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="MP.png" alt="MP">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comparing_with_reference_results">Comparing with reference results</h3>
<div class="paragraph">
<p>The <code>--refs</code> flag will take a set of reference results produced by
Litmus, Herd, or RMEM, and compare the output with the contents of
that file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_features">Advanced features</h3>
<div class="paragraph">
<p>The <code>--ifetch</code> flag generates additional events for our ARMv8
instruction fetch model. This option primarily changes the base set of
relations and sets available to the Cat memory model. Roughly
speaking, it causes instruction fetch (ifetch) events to be ordered by
fetch-program-order (fpo) and non-ifetch events to be ordered by
regular program order (po). ifetch events are related to regular
events by the (fetch-to-execute) fe relation. The ifetch events will
be in the set <code>IF</code>. Additionally there is a weak-coherence-order (wco)
in addition to the normal coherence order, and an
instruction-reads-from (irf) in addition to reads-from.</p>
</div>
<div class="paragraph">
<p>The <code>--armv8-page-tables</code> flag causes page tables to be created.
See <a href="translation.html">translation.html</a> for full details of support for virtual memory
and address translation for AArch64.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_litmus_input_format">Litmus input format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The native input file format for isla-axiomatic tests is a
<a href="https://github.com/toml-lang/toml">TOML</a> file, with various
specific keys. Below is an example of the ARMv8 MP (message-passing)
test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">arch = "AArch64"
name = "MP"
hash = "211d5b298572012a0869d4ded6a40b7f"
symbolic = ["x", "y"]

[thread.0]
init = { X3 = "y", X1 = "x" }
code = """
	MOV W0,#1
	STR W0,[X1]
	MOV W2,#1
	STR W2,[X3]
"""

[thread.1]
init = { X3 = "x", X1 = "y" }
code = """
	LDR W0,[X1]
	LDR W2,[X3]
"""

[final]
expect = "sat"
assertion = "1:X0 = 1 &amp; 1:X2 = 0"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The arch key is technically optional, but in the future may be used to
avoid having to specify the architecture and/or configuration on the
command line. The name key specifies the name of the test, which is
usually the same as the filename, it is mandatory. The hash key is
optional, and is used when the file was converted from a Herd
<code>.litmus</code> file.</p>
</div>
<div class="paragraph">
<p>The symbolic key gives names to virtual addresses. In this test we
have two unknown addresses, x and y, which are provided as a list of strings.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>addresses</code> can also be used as an alternative name for this key
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_threads">Threads</h3>
<div class="paragraph">
<p>Next the test contains the data for each thread. There is a <code>thread.N</code>
section for each thread numbered starting from <code>thread.0</code>. The code
key contains the code for each thread - isla-axiomatic does not parse
this code however, and it is directly passed to an assembler. For each
thread <code>N</code> its code will be compiled into an ELF section called
<code>litmus_N</code>. Where that section is located is determined by the
<code>[threads]</code> section of the architecture configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">[threads]
base = "0x400000"
top = "0x500000"
stride = "0x1000"</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the base address for loading the code for each thread in a
litmus test, and a stride which is the distance between each thread
in bytes. The overall range for thread memory is the half-open range
<code>[base,top)</code>. Each thread is therefore located at
<code>threads.base + (threads.stride * N)</code>.</p>
</div>
<div class="paragraph">
<p>The initial state of registers can be set using the init key for each
thread via a table of <code>register = value</code> pairs. The register names
must correspond to the register names used in the Sail model (which
may differ to those used by the assembler!). For example, in ARM
assembly the general purpose registers are called X0 to X30 for their
full 64-bit values, and W0 to W30 for their lower 32-bits. In the Sail
model, these registers are represented using registers called R0 to
R30. To facilitate using the assembler names, there is a
<code>[registers.renames]</code> section in the configuration which allows for
synonyms to underlying Sail model registers.</p>
</div>
<div class="paragraph">
<p>An important thing about the init section is it sets the register
values at the beginning of time <em>before</em> any Sail code has been
(symbolically-)executed by the tool. However, this can be problematic,
as often the top-level of a Sail ISA specification looks something
like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">function main() = {
    setup();
    while true {
        fetch_decode_execute();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here each register in the init key will be set before <code>main()</code>
is run. What happens if <code>setup()</code> initialises some registers to
architecturally-defined values? isla allows initialising registers at
an arbitrary user-defined point in time, using the <code>reset_registers</code>
builtin. This would be set up in our example model as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">#ifdef SYMBOLIC
val isla_reset_registers = "reset_registers" : unit -&gt; unit
#else
function isla_reset_registers() -&gt; unit = ()
#endif

function main() = {
    setup();
    isla_reset_registers();
    while true {
        fetch_decode_execute();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now use the reset key in our thread sections, much like the
init key, and the registers will be set when <code>isla_reset_registers()</code>
is called.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">[thread.0]
reset = { "PSTATE.EL" = "0b00" } # EL0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The register keys in the reset table are actually slightly more
general than in init and support setting individual subfields of a
larger Sail register, as is shown above for PSTATE.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is because each key in init must set the entire value of
the register, and cannot leave any parts unspecified. By the time we
call <code>isla_reset_registers</code> however, the register already has a value
and we can update only part of it. You might wonder why not use reset
for everything? The answer is that some registers may be used by
<code>reset()</code> as <em>configuration registers</em> that specify how the model
should be set up.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This is currently called <em>reset</em> due to terminology used in
the ARM specification. We may change the naming at some future point
to make things more clear.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_final_state">Final State</h3>
<div class="paragraph">
<p>The last section of the file, <code>[final]</code> contains the assertion that
the test must satisfy. We can either expect this assertion to be
satisfiable (sat) or unsatisfiable (unsat). The assertion is written
using a small assertion language, specified by the grammar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-grammar" data-lang="grammar">hex = 0x[0-F]+
bin = 0b[0-1]+
nat, thread_id = [1-9][0-9]*

loc ::= thread_id ":" register
      | "*" address

exp ::= loc "=" exp
      | hex
      | bin
      | nat
      | "true"
      | "false"
      | exp "&amp;" exp
      | exp "|" exp
      | "~" exp
      | "(" exp ")"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The operators <code>&amp;</code>, <code>|</code>, and <code>~</code> must be parenthesised to remove
ambiguity. There are no implicit precedence rules to ensure
clarity. The <code>address</code> terminal can be one of the addresses
specified by the symbolic key at the start of the file, and
<code>register</code> must be a Sail register name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_sections">Custom sections</h3>
<div class="paragraph">
<p>The file format also supports custom ELF sections in the generated
litmus test binary, these are specified using a section like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">[section.thread1_el1_handler]
address = "0x1400"
code = """
     mov x2, #1
     eret
"""</code></pre>
</div>
</div>
<div class="paragraph">
<p>The section is called <code>[section.NAME]</code> where name will the the name of
the section in the ELF. There is a check to ensure this does not clash
with any of the the generated thread sections. It will be assembled at
the specified address in the generated ELF.</p>
</div>
</div>
<div class="sect2">
<h3 id="_self_modifying_code">Self-modifying code</h3>
<div class="paragraph">
<p>To constraint the non-determinism for self-modifying code, we must
declare which addresses in the thread&#8217;s code can be modified and how,
using the <code>self_modify</code> toml array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">[[self_modify]]
address = "f:"
bytes = 4
values = [
  "0x14000001",
  "0x14000003"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the address is a label from the code, which is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">[thread.0]
init = { X1 = "f:", X0 = "0x14000001" }
code = """
        STR W0,[X1]
        BL f
        MOV W2,W10
        B Lout
f:
        B l0
l1:
        MOV W10,#2
        RET
l0:
        MOV W10,#1
        RET
Lout:
"""</code></pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen, such labels can also be used as the initial value for
registers, like X1 above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_constrained_addresses">Constrained addresses</h3>
<div class="paragraph">
<p>Constrained addresses work like the self_modify sections, but allow
restricting the values that are allowed at an address declared in a
litmus file. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-toml" data-lang="toml">symbolic = ["x", "y", "z"]

[locations]
"x" = "z"

[[constrained]]
address = "x"
bytes = 8
values = ["y", "z"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we have three addresses <code>x</code>, <code>y</code>, and <code>z</code>. The initial value at
<code>x</code> is the address of <code>z</code>. The constrained section says the 8-bytes at
this address can only contain the values of <code>y</code> or <code>z</code>. This
constrains the symbolic execution for all the threads, so we don&#8217;t get
a blow-up in the number of traces when we use a value read from memory
as an address in one thread.</p>
</div>
</div>
<div class="sect2">
<h3 id="_herd_litmus_files">Herd <code>.litmus</code> files</h3>
<div class="paragraph">
<p>Herd has its own custom format for litmus files. To facilitate working
with these files, we include a tool in the github repository
<a href="https://github.com/rems-project/isla/tree/master/isla-litmus">isla-litmus</a>
which can convert from Herd&#8217;s <code>.litmus</code> format into the TOML format
described above. This tool is written in OCaml, as it uses the parser
from Herd itself.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memory_model_language">Memory model language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The memory model language is described here <a href="memory_model_language.html">memory_model_language.html</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linking_sail_models_with_memory_models">Linking Sail models with memory models</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The previous sections have mostly discussed how the input formats to
the tool look. This section discusses how the events are generated
from the Sail model, and therefore how isla-axiomatic can be
integrated with new Sail ISA models. If you are only interested in
using the tool with existing models, this section is not-necessary,
but might still be useful for understanding how everything fits
together internally.</p>
</div>
<div class="paragraph">
<p>We can declare the events that are generated by Sail using the
<code>outcome</code> keyword in the Sail language. A standard set of these
outcomes covering things like memory accesses, barriers, and so on,
are defined in the Sail library in the <code>lib/concurrency_interface</code>
folder. Arbitrary Sail types can be put in these outcome types, and
extracted by the memory model language (see the section on that
above).</p>
</div>
<div class="paragraph">
<p>There are some other builtins we must add to our ISA specification to
ensure the concurrency model works correctly. The
<code>__branch_announce</code> builtin informs the model about the addresses
used by branch instructions. This is used for computing control
dependencies (the <code>ctrl</code> relation in Cat). For example, the
BranchToAddr function in the ARMv8 model contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">function BranchToAddr (target, branch_type) = {
    Hint_Branch(branch_type);
    if 'N == 32 then {
        assert(UsingAArch32());
        __branch_announce(64, ZeroExtend(64, target));
        _PC = ZeroExtend(target)
    } else {
        assert('N == 64 &amp; ~(UsingAArch32()));
        __branch_announce(64, slice(target, 0, 64));
        _PC = slice(target, 0, 64)
    };
    __PC_changed = true;
    return()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can&#8217;t just rely on writes to the program counter (<code>_PC</code>) because
other instructions may write to it, but not be involved in the <code>ctrl</code>
relation.</p>
</div>
<div class="paragraph">
<p>The <code>__instr_announce</code> builtin is used to tell the concurrency model
which instruction is being executed each cycle, allowing events to be
associated with the instruction that executed them. This should happen
directly after the instruction is fetched from memory. It is very
important that the top level fetch-decode-execute loop in Sail
increments the cycle counter (via the <code>"cycle_count"</code> builtin) so each
instruction announce event is associated with the right set of
events. A minimal example in Sail might look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">val __cycle_count = "cycle_count" : unit -&gt; unit
val __monomorphize = "monomorphize" : forall 'n, 'n &gt;= 0. bits('n) -&gt; bits('n)

function main() -&gt; unit = {
    setup();
    __cycle_count();
    while true {
        instr = __monomorphize(fetch());
        __instr_announce(instr);
        decode_and_execute(instr);
        __cycle_count()
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Cycle 0 (before the first call to <code>__cycle_count</code>) is reserved for initialization.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notice the use of the <code>__monomorphize</code> builtin here. This is a
special builtin that is a no-op in all other Sail backends, but in
Isla forces the symbolic execution to case-split on the value of its
argument if the argument is symbolic. This means that <code>instr</code> is
forced to always be a concrete value in <code>__instr_announce</code>.</p>
</div>
<div class="sect2">
<h3 id="_dependency_analysis">Dependency analysis</h3>
<div class="paragraph">
<p>The axiomatic concurrency models depend on <em>syntactic dependencies</em>
between instructions. In a perfect world this information would be
provided to us explicitly as part of the architecture specification,
but as large imperative ISA specifications have not typically been
integrated with concurrency tools such as Isla, this is not the case
in the real world at present.</p>
</div>
<div class="paragraph">
<p>The dependency relations we need are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>addr</strong> We get an address dependency from a load to a store or load when the address of the store or load depends on the value of the first load.</p>
</li>
<li>
<p><strong>data</strong> We get a data dependency from a load to a store when the data of the store depends on the value read by the load.</p>
</li>
<li>
<p><strong>ctrl</strong> We get a control dependency from a load to every event after a branch when the branch&#8217;s address depends on the value read by the load.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have a way to derive sensible syntactic dependencies from
the semantics of instructions. This may seem odd - how can one derive
<em>syntactic</em> dependencies from <em>semantics</em>?  The assumption here is
that the syntax itself should determine all the possible behaviours, so
if we use symbolic execution to explore all the possible behaviours of
an instruction in any starting state, we should end up with the
correct syntactic dependencies.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is neither correct to under-approximate or
over-approximate these dependencies, they must be
exact. Under-approximating would allow bad executions, and
over-approximating would forbid good ones.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The approach is roughly as follows: for each instruction in the litmus
test we execute it in an unconstrained starting state. This produces a
set of all the possible behaviours of the instruction. We then look at
those behaviours and track which registers were tainted by data read
from memory, as well as what registers flow into store, load, and
branch addresses. Using this information we can then compute the addr,
data, and ctrl relations in a straightforward way.</p>
</div>
<div class="paragraph">
<p>The <code>isla-footprint</code> command with the <code>-d</code>(<code>--dependency</code>) option can
be used to view the information generated by this process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">isla-footprint -A aarch64.ir -C configs/aarch64.toml -i "ldr w0, [x1]" -d</code></pre>
</div>
</div>
<div class="paragraph">
<p>generates:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>opcode: #xb9400020
Execution took: 159ms
Footprint:
  Memory write:
  Memory read: R0
  Memory address: R1
  Branch address:
  Register reads: TCR_EL1 SCR_EL3 PSTATE.EL SCTLR_EL1 __defaultRAM CFG_ID_AA64PFR0_EL1_EL3 EDSCR __CNTControlBase OSLSR_EL1 PSTATE.D R1 OSDLR_EL1 CFG_ID_AA64PFR0_EL1_EL1 CFG_ID_AA64PFR0_EL1_EL0 CFG_ID_AA64PFR0_EL1_EL2 PSTATE.nRW DBGEN __highest_el_aarch32
  Register writes: __LSISyndrome R0
  Register writes (ignore):
  Is store: false
  Is load: true
  Is exclusive: false
  Is branch: false</pre>
</div>
</div>
<div class="paragraph">
<p>Some registers in the Sail ARM model aren&#8217;t really architectural
registers and should be ignored for dependency analysis, these can be
added to <code>registers.ignore</code> in the architecture configuration. Usually
in ASL and therefore the ARMv8 Sail, these are prefixed by two
underscores.</p>
</div>
<div class="paragraph">
<p>Unfortunately it is sometimes possible that this process doesn&#8217;t give
us exactly the dependencies we need. There are two special builtins</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">val __mark_register = "mark_register" : forall ('a: Type). (register('a), string) -&gt; unit
val __mark_register_pair = "mark_register_pair" : forall ('a: Type) ('b: Type). (register('a), register('b), string) -&gt; unit</code></pre>
</div>
</div>
<div class="paragraph">
<p>That allows annotating registers with information (in the form of a string) at specific points during symbolic execution, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sail" data-lang="sail">__mark_register_pair(ref R0, ref R1, "ignore_edge")</code></pre>
</div>
</div>
<div class="paragraph">
<p>will cause read-write edges from R0 to R1 to be ignored,
"ignore_write" can also be used with a single register to ignore all
read-write edges into a register.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We use the <code>ref register</code> syntax in Sail to pass the registers by name to this builtin.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_dependency_analysis_for_systems_semantics">Dependency analysis for systems semantics</h3>
<div class="paragraph">
<p>While the notions of address, data, and control dependencies seem
simple enough for user-mode concurrency, things become more unclear when
we start thinking about systems features. For example: What if an
instruction behaviour changes between exception levels? Should we
included dependency information generated at all exception levels?
Does dependency information cross between exception level boundaries?
How does the MMU and address translation affect this?</p>
</div>
<div class="paragraph">
<p>In truth it seems syntactic dependencies are bit of a fuzzy concept
once we start thinking at this level. In practice when we have the MMU
enabled we can make instruction execution so non-deterministic that it
becomes computationally infeasible to evaluate all paths through an
instruction without abstracting away features. To work around these
issues in systems tests, we have a <code>--footprint-config</code> option for
<code>isla-axiomatic</code> that allows a separate architecture configuration to
be used during dependency analysis.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-12-02 20:31:06 UTC
</div>
</div>
</body>
</html>